Bootstrap: docker
From: python:3.13-slim

%post
	apt-get update && apt-get install -y --no-install-recommends build-essential git curl golang

	git clone https://github.com/donnybeelo/sanger-movie-server
	cd sanger-movie-server

	pip install --no-cache-dir -r requirements.txt

	make build
	mv movie-server /usr/local/bin/

%runscript
	python3 client.py $@

%startscript
	movie-server $@

%help
	This is a Singularity container for the Movie Server/Client for the Sanger HCI take-home test

	To run client:
	  singularity run [image-name] [options]
	Options:
	  --server SERVER      Specify the server URL
	  --port PORT          Specify the server port (default: 8080)
	  --year YEAR          Specify the year to fetch movies for
	  --username USERNAME  Specify the username for authentication
	  --password PASSWORD  Specify the password for authentication
	  --verbose            Enable verbose output (optional)
	Example:
	  singularity run movie-server.sif --year 1900 --username user --password pass --verbose

	To start server:
	  singularity instance start movie-server.sif [name] [options]
	To stop server:
	  singularity instance stop [name]
	Options:
	  -port PORT          Specify the port for the server (default: 8080)
	Example:
	  singularity instance start movie-server.sif my_server -port 8081
